<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<title>Midnight</title>
	<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
	<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0"/>
	<link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:200,400,700' rel='stylesheet' type='text/css'>
	<link href='http://fonts.googleapis.com/css?family=Source+Code+Pro' rel='stylesheet' type='text/css'>
	<link rel="stylesheet" href="style.css" type="text/css" />
	<link rel="stylesheet" href="tomorrow.css" type="text/css" />
	<script src="highlight.pack.js"></script>
	<script>hljs.initHighlightingOnLoad();</script>
	<script>
		(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
		ga('create', 'UA-37197777-2', 'msavela.github.io');
		ga('send', 'pageview');
	</script>
</head>
<body>
	<aside>
		<div style="padding: 15px">

			<h1><span class="midnight">Midnight </span><div class="moon">â˜¾</div></h1>

			<ul>
				<li><a href="#">Overview</a></li>
				<li><a href="https://github.com/msavela/midnight">Github</a></li>
			</ul>

			<h2>Guide</h2>

			<ul>
				<li><a href="#getting-started">Getting started</a></li>
				<li><a href="#new-application">New application</a></li>
				<li><a href="#router">Router</a></li>
				<li><a href="#middleware">Middleware</a></li>
				<li><a href="#static">Static files</a></li>
				<li><a href="#plugins">Plugins</a></li>
				<li><a href="#examples">Examples</a></li>
			</ul>

			<h2>API Reference</h2>

			<ul>
				<li><a href="#application">Application</a></li>
				<li><a href="#route">Route</a></li>
				<li><a href="#request">Request</a></li>
				<li><a href="#response">Response</a></li>
			</ul>
		</div>
	</aside>
	<section id="home">
		<h1 class="overview">Overview</h1>
		<h3><span class="midnight">Midnight</span> is an open source web framework for node.js without external dependencies.</h3>
		<p>Features:</p>
		<ul>
			<li>Easy to learn</li>
			<li>Powerful router</li>
			<li><strong>No 3rd-party dependencies</strong></li>
			<li>Compatible with <a href="https://github.com/senchalabs/connect">Connect</a> framework</li>
			<li>Flexible plugin system</li>
		</ul>
		<p>Here's a simple <span class="midnight">Midnight</span> application:</p>
		<pre><code class="javascript">const midnight = require("midnight");
const app = midnight();

app.route("/", (req, res) => {
	res.send("Hello world!");
});

app.start();
</code></pre>
		<p>That's it.</p>
	</section>
	<section id="guide">
		<h1>Guide</h1>

		<h2 id="getting-started">Getting started</h2>
		<p>Let's take a closer look on how to get application up and running.</p>
		<p>Install <span class="midnight">Midnight</span> using <a href="https://yarnpkg.com">Yarn</a>:</p>
		<pre><code class="bash"><span>yarn add midnight</span></code></pre>

		<p>Or using <a href="https://npmjs.org">Node Packaged Modules</a>:</p>
		<pre><code class="bash"><span>npm install midnight</span></code></pre>

		<p>Prerequisites for running a <span class="midnight">Midnight</span> application are now installed. Next step is to create a new application.</p>

		<h2 id="new-application">New application</h2>

		<p>Create new file called <span><code>app.js</code></span> with following contents:</p>

		<pre><code class="javascript">const midnight = require("midnight");
const app = midnight();

app.route("/", (req, res) => {
	res.send("Hello world!");
});

app.start();
</code></pre>

		<p>Next step is to run the application:</p>
		<pre><code class="bash"><span>node app.js</span></code></pre>

		<p>Well done, application is now running at <a href="http://localhost:8080">http://localhost:8080</a>.</p>
		<p>Scroll down to learn more about the <span class="midnight">Midnight</span> framework.</p>

		<h2 id="router">Router</h2>
		<p>Setting a new route is super easy:</p>

		<pre><code class="javascript">app
  .route("/", (req, res) => {
    res
      .status(200)
      .content("text/plain")
      .send("Hello world!");
  })
  .method(["GET", "POST"]); // Allow GET and POST requests  
</code></pre>

		<p>Route parameters can be captured as shown below:</p>
		<pre><code class="javascript">app
  .route("/post/:id", (req, res) => {
    app.log.info("Get post id %s", req.params.id);
    res
      .status(200)
      .set("Content-Type", "text/plain")
      .send("Hello world!");
  })
  .get(); // Allow GET requests only
</code></pre>

<p>Define route groups:</p>
<pre><code class="javascript">const group = app.route("/group/:group");

// Apply middleware to route group
group.use((req, res, next) => {
  res.set("Has-Parent-Middleware", true);
  next();
});

// /group/:group
group.route("/", (req, res) => {
  res.send("Route group /");
});

// /group/:group/foo/:id
group.route("/foo/:id", (req, res) => {
  res.send(req.params);
});
</code></pre>

    <p>See <a href="#route">Route</a> and <a href="#app.route">app.route</a> for more detailed documentation.</p>
    
		<h2 id="middleware">Middleware</h2>
		<p><span class="midnight">Midnight</span> is fully compatible with <a href="https://github.com/senchalabs/connect">Connect</a> framework.</p>

		<p>Following example will populate request.query object containing HTTP GET parameters:</p>
		<pre><code class="javascript">const compression = require("compression");

// Gzip/deflate all outgoing responses
app.use(compression());

app.route("/", (req, res) => {
  res.status(200).send(JSON.stringify(req.query));
});
</code></pre>

		<p>In case a route specific middleware is required:</p>
		<pre><code class="javascript">const bodyParser = require("body-parser");

app
  .route("/", (req, res) => {
    res.status(200).send(JSON.stringify(req.body));
  })
  // Parse urlencoded request bodies into req.body
  .use(bodyParser.urlencoded({ extended: false }));
</code></pre>

		<p>It's also possible to create a custom middleware:</p>
		<pre><code class="javascript">app.use((req, res, next) => {
  // Use X-Custom-Header response header with every request
  res.set("X-Custom-Header", true);
  next();
});

app.route("/", (req, res) => {
  res.send("Response status is 200");
});
</code></pre>

		<h2 id="static">Static files</h2>
		<p>Serving static files with <span class="midnight">Midnight</span> and <a href="https://github.com/senchalabs/connect">Connect</a> is easy:</p>
		<pre><code class="javascript">const serveStatic = require("serve-static");

app.use(serveStatic(path.join(app.config.root, 'static')))      
</code></pre>
		<p>Example above serves static files with a following directory layout:</p>

		<ul>
			<li>app.js</li>
			<li>
				static/
				<ul>
					<li>favicon.ico</li>
					<li>
						stylesheets/
						<ul>
							<li>style.css</li>
						</ul>
					</li>
					<li>
						javascripts/
						<ul>
							<li>utils.js</li>
						</ul>
					</li>
				</ul>
			</li>
		</ul>

		<p>Requesting <a href="http://localhost:8080/stylesheets/style.css">http://localhost:8080/stylesheets/style.css</a> serves the stylesheets with ease.</p>

		<h2 id="plugins">Plugins</h2>
		<p><span class="midnight">Midnight</span> has a flexible plugin system built-in to easily extend the application.</p>
		<p>Here's how to create a new plugin:</p>
		<pre><code class="javascript">const skyColorPlugin = {
  name: "sky-plugin",
  attach: (app, options = {}) => {
    // Called when plugin is attached
    // Options can be passed as a parameter
    this.options = options;
  },
  init: (app, next) => {
    // Called when the application is initialized
    app.sky = this.options.color;

    // Call next() when done extending the app
    next();
  }
};

// Attach the plugin with parameters
// Plugin extends the app with `sky` property
app.plugin(skyColorPlugin, {
  color: "blue"
});
</code></pre>
		<p>Application server won't start until all the plugins are initialized.</p>

		<h2 id="examples">Examples</h2>
		<p>Plenty of more examples included with the source code.</p>
		<p>Go to <a href="https://github.com/msavela/midnight">Github</a> and browse the repository.</p>
	</section>
	<section id="species">
		<h1 id="api">API Reference</h1>

		<h2 id="application">Application</h2>

		<h3 id="app.configuration">app.configure(config)</h3>
		<pre><code class="javascript">app.configure({
  port: 9000,
  views: '/templates'
});

app.log.info('Server will run at port %s', app.config.port);</code></pre>

		<p>To reveal the default configuration:</p>
		<pre><code class="javascript">app.log.info(JSON.stringify(app.config));

{
  'host': '127.0.0.1',
  'port': 8080,
  'views': '/views',
  'root': '/application/root/path',
  'env': 'development',
  'version': '0.0.1'
}</code></pre>

		<h3 id="app.start">app.start([config])</h3>
		<p>Start the application.</p>
		<pre><code class="javascript">app.start();</code></pre>

		<p>Alternatively, start the server with configuration parameter.</p>

		<pre><code class="javascript">app.start({
  port: 9000
});</code></pre>

		<h3 id="app.log">app.log</h3>
		<p>Set log level:</p>
		<pre><code class="javascript">// Default logging level
app.config.log = app.log.level.info;</code></pre>

		<p>Logging.</p>
		<pre><code class="javascript">// Trace
app.log.trace('Finely detailed information');

// Debug
app.log.debug('Detailed information');

// Info
app.log.info('Interesting runtime events');

// Warning
app.log.warn('Runtime situations that are undesirable');

// Error
app.log.error('Runtime errors or unexpected conditions');

// Fatal
app.log.fatal('This is very bad');
</code></pre>

		<h3 id="app.route">app.route(pattern, [function])</h3>
		<p>Declare a new route:</p>
		<pre><code class="javascript">app.route('/post/:id', (req, res) => {
  res.send(req.params);
});</code></pre>

		<p>Use regular expression as a route pattern:</p>
		<pre><code class="javascript">// Accept requests with url /route/{parameter}
app.route(new RegExp('^\\/route\/(?:([^\\/]+?))\\/?$', 'i'), (req, res) => {
  res.send(req.params);
});</code></pre>

		<p>Routes can be used like below to set additional parameters:</p>
		<pre><code class="javascript">app.route('/', (req, res) => {
  res.send('Hello world!');
}).get(); // Allow GET requests only</code></pre>

		<p>Leave handler argument out to simply use route specific middleware:</p>
		<pre><code class="javascript">// Use custom middleware for specific route only
app.route('/specific/route').use(yourMiddlewareHere);</code></pre>

		<p>See <a href="#router">Router</a> for more examples.</p>

		<h3 id="app.utils">app.utils</h3>
		<p>Provides few useful tools, see <a href="https://github.com/msavela/midnight">Github</a> for complete list.</a>

		<h3 id="app.use">app.use(handler)</h3>
		<p>Use middleware for all the requests.</p>
		<pre><code class="javascript">app.use(globalMiddlewareHere);</code></pre>

		<h3 id="app.plugin">app.plugin(plugin, [options])</h3>
		<p>Attach a plugin to the application.</p>
		<pre><code class="javascript">app.plugin(plugin);</code></pre>

		<p>See <a href="#plugins">Plugins</a> for more examples.</p>

		<h2 id="route">Route</h2>
		<p>See <a href="#router">Router</a> for examples on how to define routes.</p>

		<h3 id="route.method">route.method(method)</h3>
		<p>Specify allowed methods for the route</p>
		<pre><code class="javascript">// Accept GET requests
route.method('GET');

// Accept GET, POST and DELETE requests
route.method(['GET', 'POST', 'DELETE']);</code></pre>

		<p>Above is equivalent to:</p>
		<pre><code class="javascript">// Accept GET requests
route.get();

// Accept GET, POST and DELETE requests
route.get().post().delete();</code></pre>

		<p>All HTTP methods are allowed in case no method is specified.</p>

		<h3 id="route.get">route.get()</h3>
		<p>Allow GET requests.</p>
		<pre><code class="javascript">route.get();</code></pre>
		<h3 id="route.post">route.post()</h3>
		<p>Allow POST requests.</p>
		<pre><code class="javascript">route.post();</code></pre>
		<h3 id="route.put">route.put()</h3>
		<p>Allow PUT requests.</p>
		<pre><code class="javascript">route.put();</code></pre>
		<h3 id="route.delete">route.delete()</h3>
		<p>Allow DELETE requests.</p>
		<pre><code class="javascript">route.delete();</code></pre>

		<h3 id="route.use">route.use(handler)</h3>
		<p>Use middleware for specific route.</p>
		<pre><code class="javascript">const bodyParser = require("body-parser");

app
  .route("/", (req, res) => {
    res.status(200).send(JSON.stringify(req.body));
  })
  // Parse urlencoded request bodies into req.body
  .use(bodyParser.urlencoded({ extended: false }));
</code></pre>

    <h3 id="route.route">route.route</h3>
    <p>Define subroute (route group)</p>
    <pre><code class="javascript">const group = app.route("/group/:group");

// /group/:group/foo/:id
group.route("/foo/:id", (req, res) => {
  res.send(req.params);
});
    </code></pre>

		<h2 id="request">Request</h2>

		<h3 id="request.method">request.method</h3>
		<p>Get request method.</p>

		<h3 id="request.get">request.get(header)</h3>
		<p>Get request header.</p>
		<pre><code class="javascript">request.get('Content-Type');</code></pre>

		<h3 id="request.content">request.content()</h3>
		<p>Get request <code>Content-Type</code>.</p>
		<pre><code class="javascript">request.content();</code></pre>

		<h2 id="response">Response</h2>

		<h3 id="response.status">response.status(code)</h3>
		<p>Set status code.</p>
		<pre><code class="javascript">response.status(200);</code></pre>

		<h3 id="response.set">response.set(key, [value])</h3>
		<p>Set response header.</p>
		<pre><code class="javascript">// Set response header
response.set('Access-Control-Allow-Origin', '*');

// Remove response header
response.set('Access-Control-Allow-Origin');</code></pre>

		<h3 id="response.get">response.get(header)</h3>
		<p>Get response header.</p>
		<pre><code class="javascript">response.get('Content-Type');</code></pre>

		<h3 id="response.content">response.content([type])</h3>
		<p>Set <code>Content-Type</code> response header.</p>
		<pre><code class="javascript">// Set response header
response.content('image/png');

// Get response header
response.content();</code></pre>

		<h3 id="response.redirect">response.redirect(location)</h3>
		<p>Redirect to a location.</p>
		<pre><code class="javascript">response.redirect('/');</code></pre>

		<h3 id="response.encoding">response.encoding(encoding)</h3>
		<p>Set response encoding.</p>
		<pre><code class="javascript">response.encoding('utf-8');</code></pre>

		<h3 id="response.send">response.send(response)</h3>
		<p>Send a response.</p>
		<pre><code class="javascript">// Content-Type: text/html
response.send('Hello world!');</code></pre>

		<p>Depending on the object type different <code>Content-Type</code> header is used:</p>

		<pre><code class="javascript">// Content-Type: application/json
response.send({ name: 'Harry' });

// Content-Type: application/json
response.send(['Apples', 'Oranges']);

// Content-Type: application/octet-stream
response.send(new Buffer('Hello world!'));</code></pre>

		<p>This method automatically adds <code>Content-Length</code> header for the response.</p>
	</section>
</body>
</html>